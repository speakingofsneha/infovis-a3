import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.BVOCwoKb.js";import{P as v}from"./react-plotly.BKWezMxa.js";import{c as M}from"./transform.BbU07-m7.js";function w({selectedZone:o,onZoneChange:r,selectedTimeRange:i,onTimeRangeChange:d}){const g=["26","27","30","47","48","50","51","52","244"],f=[{value:"month",label:"Last Month"},{value:"quarter",label:"Last Quarter"}];return e.jsxs("div",{className:"filter-controls flex gap-4 mb-4",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"zone-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Zone"}),e.jsx("select",{id:"zone-select",value:o,onChange:a=>r(a.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:g.map(a=>e.jsxs("option",{value:a,children:["Zone ",a," "]},a))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"time-range-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Range"}),e.jsx("select",{id:"time-range-select",value:i,onChange:a=>d(a.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:f.map(a=>e.jsxs("option",{value:a.value,children:[a.label," "]},a.value))})]})]})}function A({selectedZone:o,selectedTimeRange:r}){const[i,d]=m.useState([]),[g,f]=m.useState(null),[a,y]=m.useState(null),u=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],n=[...Array(24).keys()].map(t=>{const s=t>=12?"PM":"AM";return`${t%12===0?12:t%12} ${s}`});function x(t){console.log("Creating heatmap data from:",t);const s=Array.from({length:n.length},()=>Array(u.length).fill(null));return t.forEach(h=>{const b=u.indexOf(h.day_name),c=+h.hour,l=+h.ta;b!==-1&&c!==-1&&(s[c][b]=l)}),s}return m.useEffect(()=>{console.log("Component mounted, starting data load...");const t={x:u,y:n,z:Array.from({length:n.length},()=>Array(u.length).fill(null)),type:"heatmap",colorscale:[[0,"#3F8BEA"],[.2,"#3F8BEA"],[.4,"#28B1B7"],[.6,"#95B295"],[.9,"#ED8F89"],[1,"#F8857E"]],zmin:22,zmax:26,colorbar:{title:"Temperature (°C)",titleside:"right",len:.5,y:.5,yanchor:"middle"},showscale:!0,hoverongaps:!1,hovertemplate:"<b>Day:</b> %{x}<br><b>Time:</b> %{y}<br><b>Temp:</b> %{z}°C<br><extra></extra>"},s={title:{text:`Average temperature - Zone ${o}`,x:.5,y:.95},xaxis:{title:"",side:"bottom",tickangle:0,tickvals:[...Array(u.length).keys()],ticktext:p,tickfont:{size:12},showgrid:!1},yaxis:{title:"",autorange:"reversed",tickangle:0,tickvals:[...Array(24).keys()],tickfont:{size:12},showgrid:!1},margin:{t:60,b:40,l:60,r:20},plot_bgcolor:"white",paper_bgcolor:"white",height:750,width:670,shapes:[...Array(u.length-1).fill().map((c,l)=>l===4?{type:"line",x0:l+.5,x1:l+.5,y0:-.5,y1:n.length-.5,line:{color:"white",width:4}}:{type:"line",x0:l+.5,x1:l+.5,y0:-.5,y1:n.length-.5,line:{color:"black",width:.5}}),...Array(n.length-1).fill().map((c,l)=>({type:"line",y0:l+.5,y1:l+.5,x0:-.5,x1:u.length-.5,line:{color:"black",width:.5}}))]};f(s),console.log(`Loading data for zone ${o} and time range ${r}`);const h=r==="month"?`lastmonth_zone${o}.csv`:`lastquarter_zone${o}.csv`,b=`/data/thermal comfort/heatmap/${r}/${h}`;console.log(`Loading data from: ${b}`),M(b).then(c=>{console.log("Data loaded successfully:",c);const l=x(c);d([{...t,z:l}])}).catch(c=>{console.error("Error loading the CSV file:",c),y(c.message)})},[o,r]),a?e.jsxs("div",{children:["Error loading data: ",a]}):e.jsx("div",{children:i.length>0&&g&&e.jsx(v,{data:i,layout:g,config:{responsive:!0}})})}function j({selectedZone:o,selectedTimeRange:r}){const[i,d]=m.useState([]),[g,f]=m.useState(null),[a,y]=m.useState(null),u=["12 AM","1 AM","2 AM","3 AM","4 AM","5 AM","6 AM","7 AM","8 AM","9 AM","10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM","7 PM","8 PM","9 PM","10 PM","11 PM"];function p(n){console.log("Creating box plot data from:",n),n.forEach(t=>{t.hour=+t.hour,t.mean=+t.mean,t.std=+t.std,t.min=+t.min,t.max=+t.max,t.count=+t.count});const x=[];return n.forEach(t=>{t.hour>=0&&t.hour<=23&&x.push({type:"box",y:[t.min,t.min,t.mean-t.std,t.mean,t.mean+t.std,t.max,t.max],name:u[t.hour],boxpoints:!1,marker:{color:"#3D72D5"},line:{width:1.5},fillcolor:"#3D72D5",boxwidth:.9,showlegend:!1,customdata:[[t.mean,t.min,t.max,t.std,t.count]],hovertemplate:"<b>Time:</b> %{x}<br><b>Mean Temperature:</b> %{customdata[0]:.1f}°C<br><b>Min:</b> %{customdata[1]:.1f}°C<br><b>Max:</b> %{customdata[2]:.1f}°C<br><b>Std Dev:</b> %{customdata[3]:.1f}°C<br><b>Data Points:</b> %{customdata[4]}<br><extra></extra>"})}),x}return m.useEffect(()=>{console.log("Component mounted, starting data load...");const n={title:{text:`Temperature Variability - Zone ${o}`,x:.5},yaxis:{title:"Temperature (°C)",range:[20,27],gridcolor:"#E5E5E5",zeroline:!1},xaxis:{title:"",gridcolor:"#E5E5E5",zeroline:!1},plot_bgcolor:"white",paper_bgcolor:"white",boxmode:"group",height:750,width:670,margin:{t:80,b:60,l:80,r:60},shapes:[{type:"line",x0:-.5,x1:23.5,y0:21,y1:21,line:{color:"blue",width:1.5,dash:"dash"}},{type:"line",x0:-.5,x1:23.5,y0:25,y1:25,line:{color:"red",width:1.5,dash:"dash"}}],annotations:[{x:21,y:25.3,text:"Cooling Set Point",showarrow:!1,font:{color:"red"}},{x:21,y:20.7,text:"Heating Set Point",showarrow:!1,font:{color:"blue"}}]};f(n),console.log(`Loading data for zone ${o} and time range ${r}`);const x=r==="month"?`may_zone${o}.csv`:`lastquarter_zone${o}.csv`,t=`/data/thermal comfort/boxplot/${r}/${x}`;console.log(`Loading data from: ${t}`),M(t).then(s=>{console.log("Data loaded successfully:",s);const h=p(s);d(h)}).catch(s=>{console.error("Error loading the CSV file:",s),y(s.message)})},[o,r]),a?e.jsxs("div",{className:"p-4 text-red-600",children:["Error loading data: ",a]}):e.jsx("div",{className:"w-full",children:i.length>0&&g&&e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{data:i,layout:g,config:{responsive:!0}})})})}function $(){const[o,r]=m.useState("8"),[i,d]=m.useState("month");return e.jsxs("div",{children:[e.jsx(w,{selectedZone:o,onZoneChange:r,selectedTimeRange:i,onTimeRangeChange:d}),e.jsxs("div",{className:"charts-container",children:[e.jsx(A,{selectedZone:o,selectedTimeRange:i}),e.jsx(j,{selectedZone:o,selectedTimeRange:i})]})]})}export{$ as default};
