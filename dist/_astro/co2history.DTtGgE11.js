import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BVOCwoKb.js";import{P as D}from"./react-plotly.BKWezMxa.js";import{c as F}from"./transform.BbU07-m7.js";function P(){const[r,w]=o.useState("12hours"),[l,N]=o.useState("0"),[c,f]=o.useState([]),[x,g]=o.useState(null),[n,d]=o.useState(null),[m,b]=o.useState(!0),C=["0","25","26","27","28","29","30"],y=[{value:"12hours",label:"Last 12 Hours"},{value:"24hours",label:"Last 24 Hours"}];return o.useEffect(()=>{(async()=>{b(!0),d(null);try{const u=`co2history_floor${l}.csv`,S=`/data/air quality/history/${r}/${u}`,h=await F(S);if(!h||h.length===0)throw new Error("No data available for the selected parameters");const v=new Set,j=h.filter(e=>{const s=e.time||e.hour||e.timestamp;return!s||v.has(s)?!1:(v.add(s),!0)}),i=j.map(e=>e.time||e.hour||e.timestamp),p=j.map(e=>+e.co2),$=[{x:i,y:p,type:"scatter",mode:"lines",line:{color:"#79D7B3"},name:"CO₂ ppm"}],k={title:{text:`CO₂ History; ${y.find(e=>e.value===r)?.label||""}${l!=="all"?` - Floor ${l}`:""}`,x:.5},xaxis:{title:"Hour of Day",tickmode:"array",tickvals:r==="24hours"?i.filter((e,s)=>s%2===0):i,ticktext:(r==="24hours"?i.filter((e,s)=>s%2===0):i).map(e=>{const s=parseInt(e);return s===0?"12 AM":s===12?"12 PM":s>12?`${s-12} PM`:`${s} AM`}),type:"category"},yaxis:{title:"CO₂ Concentration (ppm)",range:[Math.min(...p,400),Math.max(...p,800)]},height:550,width:1356,plot_bgcolor:"white",paper_bgcolor:"white"};f($),g(k),d(null)}catch(u){d(u.message),f([]),g(null)}finally{b(!1)}})()},[r,l]),t.jsxs("div",{children:[t.jsxs("div",{className:"filter-controls flex gap-4 mb-4",children:[t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{htmlFor:"time-range-select",className:"block text-sm font-medium mb-1",children:"Time Range"}),t.jsx("select",{id:"time-range-select",value:r,onChange:a=>w(a.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none",children:y.map(a=>t.jsx("option",{value:a.value,children:a.label},a.value))})]}),t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{htmlFor:"floor-select",className:"block text-sm font-medium mb-1",children:"Floor"}),t.jsx("select",{id:"floor-select",value:l,onChange:a=>N(a.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none",children:C.map(a=>t.jsx("option",{value:a,children:a==="0"?"Lobby":`Floor ${a}`},a))})]})]}),t.jsxs("div",{style:{minHeight:550,position:"relative"},children:[m&&t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"white",zIndex:2}}),!m&&!n&&c.length>0&&x&&t.jsx(D,{data:c,layout:x,config:{responsive:!0}}),!m&&!n&&c.length===0&&t.jsx("div",{className:"text-gray-600 p-4 text-center",children:"No data available for the selected parameters"}),n&&t.jsxs("div",{className:"text-red-600 mb-4 p-4 bg-red-50 rounded",children:["Error loading data: ",n]})]})]})}export{P as default};
