import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.BVOCwoKb.js";import{P as E}from"./react-plotly.BKWezMxa.js";import{c as $}from"./transform.BbU07-m7.js";import{t as g}from"./defaultLocale.BPyJQ740.js";function H(){const[a,k]=i.useState("daily"),[r,C]=i.useState("0"),[h,f]=i.useState([]),[p,y]=i.useState(null),[b,m]=i.useState(null),[N,x]=i.useState(!0),D=["0","25","26","27","28","29","30"],F=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"}],u=(e,c)=>{const d=new Date(e);switch(c){case"daily":return g("%b %d")(d);case"weekly":return g("%b %d")(d);case"monthly":return g("%B")(d);default:return e}};return i.useEffect(()=>{(async()=>{x(!0),m(null);try{console.log("Loading data for:",a,"floor:",r);const c=`comftrends_floor${r}.csv`,d=`/data/thermal comfort/trends/${a}/${c}`;console.log("Loading from path:",d);const l=await $(d);if(!l||l.length===0)throw new Error("No data available for the selected parameters");console.log("Loaded CSV data:",l);let s,n;a==="daily"?(s=l.map(o=>u(o.date,"daily")),n=l.map(o=>+o.comfortable)):a==="weekly"?(s=l.map(o=>u(o.week_start,"weekly")),n=l.map(o=>+o.comfortable)):(s=l.map(o=>u(o.month,"monthly")),n=l.map(o=>+o.comfortable));const v=n.map(o=>Math.max(0,100-o)),w=n.map(()=>0);console.log("Processed data:",{xLabels:s,comfortable:n,tooHot:v,tooCold:w});const L=[{x:s,y:n,name:"Comfortable (21-25°C)",type:"bar",marker:{color:"#FDD07A"}},{x:s,y:v,name:"Too Hot (>25°C)",type:"bar",marker:{color:"#FF7057"}},{x:s,y:w,name:"Too Cold (<21°C)",type:"bar",marker:{color:"#3D72D5"}}],S={barmode:"stack",title:{text:`${a.charAt(0).toUpperCase()+a.slice(1)} Comfort Conditions${r!=="all"?` - ${r==="0"?"Lobby":`Floor ${r}`}`:""}`,x:.5},xaxis:{title:a.charAt(0).toUpperCase()+a.slice(1),tickangle:0,tickfont:{size:12}},yaxis:{title:"Percent Time",range:[0,100]},legend:{orientation:"v",x:1.05,y:1},margin:{r:120,b:80},height:750,width:1356,plot_bgcolor:"white",paper_bgcolor:"white"};console.log("Setting plot data and layout"),f(L),y(S),m(null)}catch(c){console.error("Error loading data:",c),m(c.message),f([]),y(null)}finally{x(!1)}})()},[a,r]),t.jsxs("div",{children:[t.jsxs("div",{className:"filter-controls flex gap-4 mb-4",children:[t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{htmlFor:"time-range-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Range"}),t.jsx("select",{id:"time-range-select",value:a,onChange:e=>k(e.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:F.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]}),t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{htmlFor:"floor-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),t.jsx("select",{id:"floor-select",value:r,onChange:e=>C(e.target.value),className:"block w-40 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:D.map(e=>t.jsx("option",{value:e,children:e==="0"?"Lobby":`Floor ${e}`},e))})]})]}),t.jsx("div",{style:{minHeight:750,position:"relative"},children:N?t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"white",zIndex:2},children:t.jsx("div",{className:"text-gray-600",children:"Loading chart data..."})}):b?t.jsxs("div",{className:"text-red-600 mb-4 p-4 bg-red-50 rounded",children:["Error loading data: ",b]}):h.length>0&&p?t.jsx(E,{data:h,layout:p,config:{responsive:!0}}):t.jsx("div",{className:"text-gray-600 p-4 text-center",children:"No data available for the selected parameters"})})]})}const j=document.createElement("style");j.textContent=`
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
`;document.head.appendChild(j);export{H as default};
